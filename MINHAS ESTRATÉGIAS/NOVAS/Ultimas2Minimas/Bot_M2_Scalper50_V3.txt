//Muda parametros de pontos das entradas da versão 1
//Adiciona Fechamento zero maior que os dois anterios
//Muda a lógica da compra. Compra se fechar acima da media e vende se fechar abaixo das mínimas
// Stop um corpo de box
// Alvo 3 corpo de box
// no 16R Gain225 L75
Input
MMExpPeriodo(2);
PeriodoMinimas(2);
qtdContratos(1);

Var
MediaExponencial, nUltimasDuasMinimas, CondicaoUm, CondicaoDois : Float;
FechamentoVenda, FechamentoCompra : boolean;
Begin
   SetPlotColor(1, clYellow);
   SetPlotColor(2, clGray);
   SetPlotColor(3, clGreen);
   if (Fechamento > Fechamento[1]) e (Fechamento > Fechamento[2]) then Inicio FechamentoVenda := True; Fim;
   MediaExponencial := MediaExp(MMExpPeriodo,Maxima);
   nUltimasDuasMinimas := Lowest(Low, PeriodoMinimas)[1];
      
   Se (Fechamento < nUltimasDuasMinimas) e (fechamento[1] < Fechamento[2]) então
     Inicio
       PaintBar(ClRed);
     Fim;
   Se (Fechamento > MediaExponencial) e (fechamento[1] > Fechamento[2])  então
     Inicio
        PaintBar(ClGreen);
     Fim;
    
   Se (HasPosition = False) então
      Inicio
         Se (Fechamento > MediaExponencial) e (fechamento[1] > Fechamento[2]) então
           Inicio
              BuyAtMarket(qtdContratos);
           Fim;
         Se (Fechamento < nUltimasDuasMinimas) e (fechamento[1] < Fechamento[2]) então
           Inicio
              SellShortAtMarket(qtdContratos);
           Fim;
      Fim;

   Plot(MediaExponencial);
   Plot2(nUltimasDuasMinimas);
End;               